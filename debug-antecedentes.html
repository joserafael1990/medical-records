<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Antecedentes</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Debug: Campos de Antecedentes</h1>
    
    <div class="debug-section info">
        <h3>üìã L√≥gica de Visibilidad</h3>
        <p>Los campos de antecedentes deben aparecer cuando:</p>
        <ul>
            <li><strong>Paciente nuevo</strong> (isNewPatient === true)</li>
            <li><strong>Edici√≥n de consulta "Primera vez"</strong> (consultation.consultation_type === 'Primera vez')</li>
            <li><strong>Cita seleccionada "Primera vez"</strong> (selectedAppointment.consultation_type === 'Primera vez')</li>
        </ul>
    </div>

    <div class="debug-section">
        <h3>üß™ Casos de Prueba</h3>
        <div id="test-cases">
            <p>Cargando casos de prueba...</p>
        </div>
    </div>

    <div class="debug-section">
        <h3>üìä Estado Actual</h3>
        <div id="current-state">
            <p>Abriendo la consola del navegador para ver los logs...</p>
        </div>
    </div>

    <script>
        // Simulaci√≥n de la l√≥gica de shouldShowFirstTimeFields
        function shouldShowFirstTimeFields(isNewPatient, consultation, selectedAppointment) {
            const isNewPatientFlow = isNewPatient === true;
            const isEditingFirstTimeConsultation = consultation && consultation.consultation_type === 'Primera vez';
            const hasFirstTimeAppointment = selectedAppointment && selectedAppointment.consultation_type === 'Primera vez';
            const shouldShow = isNewPatientFlow || isEditingFirstTimeConsultation || hasFirstTimeAppointment;
            
            return {
                isNewPatientFlow,
                isEditingFirstTimeConsultation,
                hasFirstTimeAppointment,
                shouldShow,
                reason: shouldShow ? 
                    (isNewPatientFlow ? 'new patient' : 
                     isEditingFirstTimeConsultation ? 'editing first time consultation' : 
                     hasFirstTimeAppointment ? 'first time appointment selected' : 'unknown') : 
                    'no conditions met'
            };
        }

        // Casos de prueba
        const testCases = [
            {
                name: "Nueva consulta + Paciente nuevo",
                isNewPatient: true,
                consultation: null,
                selectedAppointment: null
            },
            {
                name: "Nueva consulta + Cita Primera vez",
                isNewPatient: false,
                consultation: null,
                selectedAppointment: { consultation_type: 'Primera vez' }
            },
            {
                name: "Nueva consulta + Cita Seguimiento",
                isNewPatient: false,
                consultation: null,
                selectedAppointment: { consultation_type: 'Seguimiento' }
            },
            {
                name: "Edici√≥n consulta Primera vez",
                isNewPatient: false,
                consultation: { consultation_type: 'Primera vez' },
                selectedAppointment: null
            },
            {
                name: "Edici√≥n consulta Seguimiento",
                isNewPatient: false,
                consultation: { consultation_type: 'Seguimiento' },
                selectedAppointment: null
            }
        ];

        // Renderizar casos de prueba
        const testCasesDiv = document.getElementById('test-cases');
        testCasesDiv.innerHTML = testCases.map(testCase => {
            const result = shouldShowFirstTimeFields(
                testCase.isNewPatient, 
                testCase.consultation, 
                testCase.selectedAppointment
            );
            
            const statusClass = result.shouldShow ? 'success' : 'error';
            const statusIcon = result.shouldShow ? '‚úÖ' : '‚ùå';
            
            return `
                <div class="debug-section ${statusClass}">
                    <h4>${statusIcon} ${testCase.name}</h4>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                </div>
            `;
        }).join('');

        // Mostrar instrucciones
        document.getElementById('current-state').innerHTML = `
            <div class="debug-section info">
                <h4>üîß Instrucciones para Debug</h4>
                <ol>
                    <li>Abre la consola del navegador (F12)</li>
                    <li>Ve a la aplicaci√≥n en <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></li>
                    <li>Abre "Nueva Consulta"</li>
                    <li>Selecciona "S√≠" para "¬øConsulta con previa cita?"</li>
                    <li>Selecciona una cita de tipo "Primera vez"</li>
                    <li>Observa los logs en la consola</li>
                </ol>
            </div>
        `;
    </script>
</body>
</html>
